{# Sidebar fragment for the Node.js node. Filename must match Node.key (node). #}
{% load static %}
<section id="node-node" class="sidebar-section">

  <header class="sidebar-header">
    <h2 class="sidebar-title">{{ node.label|default:"Node.js" }}</h2>
    {% if node.category %}
      <p class="sidebar-category">Category: {{ node.get_category_display }}</p>
    {% endif %}
  </header>

  <section class="sidebar-block">
    <h3>Overview</h3>
    <p>
      Node.js is a free, open-source JavaScript runtime environment that:
    </p>
    <ul>
        <li>lets you execute JavaScript code outside of a web browser</li>
        <li>enables server-side development with JavaScript</li>
    </ul>
    <p>
        In this section, you will learn the role Node.js plays and the difference between Node.js vs browser runtime environments.
    </p>
  </section>

  <section class="sidebar-block sidebar-facts">
    <div><strong>Estimated time:</strong> 30 minutes</div>
    <div><strong>Difficulty:</strong> Beginner</div>
  </section>

  <section class="sidebar-block">
    <!-- Node.js Introduction -->
    <h2>Node.js</h2>
    <p>
      Since we briefly introduced Node.js as a JavaScript runtime environment for the <strong>server side (backend)</strong>, let's look at some of its characteristics.
    </p>

    <ul>
      <li><strong>Node.js is asynchronous</strong>: it can keep working while waiting on other tasks (eg like reading files or talking to a database)</li>
      <li><strong>Node.js files have <code class="inline-code">.js</code> extension</strong></li>
    
    </ul>

    <!-- Creating and Launching a Server with Node.js -->
    <h3>Creating and Launching a Server with Node.js</h3>
    <p>
      To create a server, follow the steps below: 
    </p>
    <ol>
        <li>First, verify you have Node.js installed by running the following commands, which should return the versions:</li>
        <pre><code>
        node --version 
        npm --version
        </code></pre>
        <li>Create a file with any name but ending with the <code class="inline-code">.js</code> extension (eg <code class="inline-code">firstServer.js</code>) </li>
        <li>Add the following block of code into the file</li>
        <pre><code>
        let http = require('http'); 
        http.createServer(function (req, res) {
            res.writeHead(200, {'Content-Type': 'text/html'});
            res.end('Hello World!');
        }).listen(8080);
        </code></pre>
        <li>
            Node.js files must be initiated in the Command Line interface. Navigate to the folder that contains the file "<code class="inline-code">firstServer.js</code>"
        --> go to the CLI --> initiate Node.js file.</li>
        <pre><code>
        node firstServer.js
        </code></pre>
        <li>Your server has now been initiated. </li>
    </ol>
    <p><strong>Here's a summary of what happened: </strong></p>
    <ol>
        <li>Node.js loades the built-in <code class="inline-code">http</code> module</li>
        <li>This module allows us to create a server that listens for HTTP requests on your port 8080</li>
        <li>Each time a client visits your server, Node.js calls your callback function</li>
        <li>The server sends back an HTML response with "Hello World!", according to the above code block we wrote</li>
        <li>Browser displays the message back to the client</li>
    </ol>
    
    <!-- Browser -->
    <h2>Browsers</h2>
    <p>
      In addition to Node.js, another JavaScript environment is browser. 
    </p>
    <p>
        Browser is a JavaScript runtime environment for the 
    </p>
    <img 
      src="{%static 'roadmap/img/ipv4-vs-ipv6.png' %}"
      alt="IPv4 vs IPv6 Comparison Table Diagram"
    >
    <p>
      As with networks, IPs also have <strong>Public IP Addresses</strong> and <strong>Private IP Addresses</strong>.
    </p>
    <ul>
      <li><strong>Public IP Addresses</strong>: used to identify devices on the Internet</li>
      <li><strong>Private IP Addresses</strong>: used to identify devices amongst other devices within a private network</li>
    </ul>

    <!-- MAC -->
    <h2>MAC Addresses</h2>
    <p>
      <strong>Media Access Control (MAC) Addresses</strong> are unique identifiers for a device. Devices on a network 
      have a physical network interface (eg microchip) on its motherboard. Below are some important characteristics:
    </p>
    <ul>
      <li>It consists of a 12 character hexadecimal number, with each pair being split by a colon</li>
      <li>First six characters are unique identifiers for the company that manufactured it</li>
      <li>Last six characters are unique to the device. </li>
    </ul>
    <img 
      src="{% static 'roadmap/img/mac-address.png' %}"
      alt="Mac Address Anatomy"
    >

    <!-- Router -->
     <h2>Router</h2>
     <p>
      <strong>Routers</strong> are devices that connects your local private network to the internet (public network). It is essentially 
      a dispatcher for your local devices: it decides where data should go (eg from device to device or device to internet). 
      The router has <strong>two IPs</strong>:
     </p>
     <ul> 
      <li><strong>Private IP</strong>: facing local devices </li>
      <li><strong>Public IP</strong>: facing internet </li>
    </ul>

    <h3>Network Address Translation (NAT)</h3>
    <p>NAT is a protocol that runs inside your router, and manages multiple devices, allowing these devices to share one, singular
      public IP address. For instance:
    </p>
    <ul>
      
      <li>Your Phone IP: 123.456.8.9</li>
      <li>Your Laptop IP: 239.348.49.10</li>
      <li>Your Tablet IP: 289.327.29.28</li>
    </ul>
    <p>      
      But as all of these go through your router's NAT protocol, they will appear to the internet with the same  
      <strong>public IP: 203.19.192.10</strong>.
    </p>

    <!-- ARP -->
    <h3>Address Resolution Protocol (ARP)</h3>
    <p>The Address Resolution Protocol (ARP) is what allows your local devices on your private network to recognize the router in
      that local netork. Although your laptop knows the private IP address of your router, in order to send <strong>data</strong>, 
      the laptop needs to locate the router via the router's <strong>MAC address</strong>. This protocol is called the ARP.
    </p>
  </section>

  <section class="sidebar-block">
    <!-- Putting All Concepts Together -->
    <h2>Putting All Concepts Together</h2>
    <p>
      Now, we'll put all of these concepts into play with an example. 
    </p>

    <h3>Step 1: Local Network Communication (Laptop -> Router)</h3>
    <ol>
      <li>
        Your laptop needs to send data. It only knows the router's <strong>private IP</strong> (eg 158.283.12.92), not its MAC address. In order for
        your laptop to send data, it must locate your router via its <strong>MAC address</strong>
      </li>
      <li>Your laptop conducts an <strong>ARP broadcast</strong>; basically broadcasts to all the devices on its local network
      "Who has 158.283.12.92?"
      </li>
      <li>The router identifies itself directly to your laptop by responding with its <strong>MAC Address</strong>.</li>
      <li>Your laptop now sends data to your router via its MAC Address.</li>
    </ol>

    <h3>Step 2: Router Conducts NAT (Network Address Translation) </h3>
    <ol>
      <li>The router receives the data from your laptop.</li>
      <li>The router uses the NAT protocol to replacing your laptop's private IP with the router's public IP address (eg 203.19.192.10)</li>
    </ol>
    
    <h3>Step 3: Router Sends Data to Internet</h3>
    <ol>
      <li>Your router sends the data to the Internet to the destination server.</li>
      <li>Servers on the internet only see your <strong>public IP</strong>, never the private IPs.</li>
    </ol>

  </section>

  <section class="sidebar-block">
    <h3>Check your understanding</h3>
    <!-- Question 1 -->
    <details>
      <summary>What is the old and modern IP formats?</summary>
      <ul>
        <li>IPv4 (old)</li>
        <li>IPv6 (modern)</li>
      </ul>
    </details>
    <!-- Question 2 -->
    <details>
      <summary>What are the two types of IP addresses?</summary>
        <ul>
          <li>Public IP - used to identify devices on a public network (eg Internet)</li>
          <li>Private IP - used to identify devices on the same private, local network (eg your home network)</li>
        </ul>
    </details>
    <!-- Question 3 -->
    <details>
      <summary>What is a MAC Address and what is its purpose? </summary>
        <ul>
          <li>MAC Address - is essentially your device's physical address on a local network</li>
          <li>It is used to deliver data from a device to another device on the same network</li>
        </ul>
    </details>
    <!-- Question 4 -->
    <details>
      <summary>How is information sent from your laptop to the internet?</summary>
      <ol>
        <li>Your laptop uses ARP broadcast to locate the router in its local network with a corresponding private IP</li>
        <li>The router responds to the laptop's broadcast by directly sending its MAC Address</li>
        <li>Your laptop uses this MAC Address to send data to the router</li>
        <li>The router then runs this data through NAT to assign its public IP to replace the laptop's private IP </li>
        <li>The router sends data to the desintation server on the Internet</li>
      </ol>
    </details>
    <!-- Question 5 -->
    <details>
      <summary>Internet servers can access your laptop's private IP address directly. True or False?</summary>
      <ul>
        <li>No, your laptop will present data with your router's public IP</li>
      </ul>
    </details>
  </section>

  <section class="sidebar-block">
    <h3>Resources</h3>
    <ul>
      {% if node.url %}
        <li><a href="{{ node.url }}" target="_blank" rel="noopener">Primary learning resource</a></li>
      {% endif %}
      <li><a href="https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/" target="_blank">Cloudflare TCP/IP Overview ↗</a></li>
      <li><a href="https://tryhackme.com/room/whatisnetworking" target="_blank">What is Networking?</a></li>
    </ul>
  </section>

</section>
